@using Ide.Models.DTOs;
@model LoginAndAddUserDto;
@{
    Layout = "";
}


<!doctype html>
<html lang="en">

<head>

    <meta charset="utf-8" />
    <title>Login | Minible - Admin & Dashboard Template</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Premium Multipurpose Admin & Dashboard Template" name="description" />
    <meta content="Themesbrand" name="author" />
    <!-- App favicon -->
    <link rel="shortcut icon" href="~/assets/images/favicon1.ico">

    <!-- Bootstrap Css -->
    <link href="~/assets/css/bootstrap.min.css" id="bootstrap-style" rel="stylesheet" type="text/css" />
    <!-- Icons Css -->
    <link href="~/assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <!-- App Css-->
    <link href="~/assets/css/app.min.css" id="app-style" rel="stylesheet" type="text/css" />
    <link href="~/assets/libs/toastr/build/toastr.min.css" rel="stylesheet"/>
</head>

<body class="authentication-bg">

    <div class="modal fade" id="newUserModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal" role="document">
            <div class="modal-content ">
                <div class="modal-header">
                    <h5 class="modal-title " id="modalTitleId">Kayıt Formu</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" data-bs-target="#newUserModal" aria-label="Close"></button>
                </div>
                <form id="frmAddUser" class="needs-validation">
                    <div class="modal-body">

                        <div class="container">

                            <div class="mb-3 row">
                                <label for="inputName" class="col-4 col-form-label">İsim</label>
                                <div class="col-8">
                                    <input type="text" class="form-control input-mask" parsley-type="email" required id="txtName" placeholder="İsminizi Giriniz">
                                </div>
                            </div>

                            <div class="mb-3 row">
                                <label for="inputPass" class="col-4 col-form-label">Şifre</label>
                                <div class="col-8">
                                    <input type="password" class="form-control input-mask" required id="txtPass" placeholder="Şifre Giriniz">
                                </div>
                            </div>
                            <div class="mb-3 row">
                                <label for="inputPass" class="col-4 col-form-label"></label>
                                <div class="col-8">
                                    <input type="password" class="form-control input-mask" required data-parsley-equalto="#txtPass" placeholder="Şifrenizi Tekrar Giriniz">
                                </div>
                            </div>

                            <div class="mb-3 row">
                                <label for="inputMail" class="col-4 col-form-label">Email</label>
                                <div class="col-8">
                                    <input type="email" class="form-control input-mask" parsley-type="email" required id="txtEmail" placeholder="Sisteme giriş için kullanılacaktır">
                                </div>
                            </div>



                            <div class="mb-3 row">
                                <label for="inputName" class="col-4 col-form-label">GSM</label>
                                <div class="col-8">
                                    <input type="text" data-parsley-minlength="13" maxlength="13" class="form-control input-mask" data-parsley-pattern="^\(5\d{2}\)-\d{7}$" data-inputmask="'mask': '(999)-9999999'" id="txtGsm" required placeholder="GSm Numarasını giriniz">
                                </div>
                            </div>

                          
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-bs-target="#newUserModal">Kapat</button>
                        <button type="submit" id="btnSave" class="btn btn-primary">Ekle</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <div class="account-pages my-5 pt-sm-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="text-center">
                        <a class="mb-5 d-block auth-logo">
                            <img src="~/assets/images/logos.png" alt="" height="100" class="logo logo-dark">
                            <img src="~/assets/images/logos.png" alt="" height="100" class="logo logo-light">
                        </a>
                    </div>
                </div>
            </div>
            <div class="row align-items-center justify-content-center">
                <div class="col-md-8 col-lg-6 col-xl-5">
                    <div class="card">

                        <div class="card-body p-4">
                            <div class="text-center mt-2">
                                <h5 class="text-primary">Idefix-Outlet Satışına Hoş Geldiniz !</h5>
                                <p class="text-muted">Alışveriş için giriş yapın.</p>
                            </div>
                            <div class="p-2 mt-4">
                                <form action="Login" method="post">

                                    <div class="mb-3">
                                        <label class="form-label" for="username">Email</label>
                                        <input asp-for="Email" required type="email" class="form-control" id="email" placeholder="Email giriniz.">
                                    </div>

                                    <div class="mb-3">
                                       
                                        <label class="form-label" for="userpassword">Şifre</label>
                                        <input asp-for="Password" required type="password" class="form-control" id="userpassword" placeholder="Şifrenizi giriniz.">
                                    </div>

                                    <div class="form-check">
                                        <input asp-for="IsPersistent"  type="checkbox" class="form-check-input" id="auth-remember-check">
                                        <label class="form-check-label" for="auth-remember-check">Beni Hatırla.</label>
                                    </div>

                                    <div class="mt-3 text-end">
                                        <button class="btn btn-primary w-sm waves-effect waves-light" type="submit">Giriş Yap</button>
                                    </div>



                                

                                    <div class="mt-4 text-center">
                                        <p class="mb-0">Hesabın Yok mu ? Aşağıdaki Hesap Oluştur Tuşuna Basabilir ve Hesabını Oluşturabilirsin ! </p>
                                    </div>
                                    <div class ="mt-3 text-end">
                                        <btn class="btn btn-danger w-sm waves-effect waves-light" id="newUser">Hesap Oluştur</btn>
                                    </div>
                                </form>
                            </div>

                        </div>
                    </div>

                    <div class="mt-5 text-center">
                        <p>© <script>document.write(new Date().getFullYear())</script> SSH <i class="mdi mdi-heart text-danger"></i> by ThisRak</p>
                    </div>

                </div>

            </div>


            <!-- end row -->
        </div>
        <!-- end container -->
    </div>

    <!-- JAVASCRIPT -->
    <script src="~/assets/libs/jquery/jquery.min.js"></script>
    <script src="~/assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="~/assets/libs/metismenu/metisMenu.min.js"></script>
    <script src="~/assets/libs/simplebar/simplebar.min.js"></script>
    <script src="~/assets/libs/node-waves/waves.min.js"></script>
    <script src="~/assets/libs/waypoints/lib/jquery.waypoints.min.js"></script>
    <script src="~/assets/libs/jquery.counterup/jquery.counterup.min.js"></script>
    <script src="~/assets/libs/inputmask/min/jquery.inputmask.bundle.min.js"></script>
    <script src="~/assets/libs/parsleyjs/parsley.min.js"></script>
    <script src="~/assets/libs/parsleyjs/i18n/tr.js"></script>
    <script src="~/assets/libs/inputmask/min/jquery.inputmask.bundle.min.js"></script>
    <script src="~/assets/js/pages/form-mask.init.js"></script>

    <!-- App js -->
    <script src="~/assets/js/app.js"></script>
    <script src="~/assets/libs/toastr/build/toastr.min.js"></script>

    <script>

        toastr.options = {
            "closeButton": true,
            "debug": false,
            "newestOnTop": false,
            "progressBar": true,
            "positionClass": "toast-top-center",
            "preventDuplicates": false,
            "onclick": null,
            "showDuration": 300,
            "hideDuration": 1000,
            "timeOut": 2000,
            "extendedTimeOut": 1000,
            "showEasing": "swing",
            "hideEasing": "linear",
            "showMethod": "slideDown",
            "hideMethod": "slideUp"
        }

        @if (TempData["error"] != null)
        {
            <text>
                toastr["error"]("@TempData["error"].ToString()");
            </text>
        }
        @if(TempData["success"] != null){

            <text>
                toastr["success"]("@TempData["success"].ToString()");
            </text>
        }

        $("#newUser").click(function(){
                $("#newUserModal").modal("show");
                $("#frmAddUser").removeClass("was-validated");
                $('#frmAddUser').parsley().reset();

                $("#btnSave").off().click(function () {
                    event.preventDefault();
                    if ($("#frmAddUser").parsley().isValid() === false) {
                        $('#frmAddUser').parsley().validate();
                        $("#frmAddUser").addClass("was-validated");
                    } else {

                        var formData = new FormData();

                       
                        formData.append("name", $("#txtName").val());
                        formData.append("email", $("#txtEmail").val());
                        formData.append("gsm", $("#txtGsm").val());
                        formData.append("password", $("#txtPass").val());
                       




                        $.ajax({
                            type: 'POST',
                            url: '/User/UserAdd/',
                            data: formData,
                            contentType: false,
                            processData: false,
                            success: function (res) {
        
                              if(res.result){
                                    toastr.success(res.message);
                                    $("#newUserModal").modal("hide");


                              }else{
                                    toastr.error(res.message);
                                    $("#newUserModal").modal("hide");

                              }
                               

                            },
                            error: function (res) {
                                toastr.error("İşlem başarısız", "!");
                            }
                        });

                    }
                })

        })
    </script>
</body>
</html>
